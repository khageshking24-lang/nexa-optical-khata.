<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pradeep Verma | Nexa Opticals</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
        :root { --bg: #0f172a; --card: rgba(30, 41, 59, 0.7); --text: #ffffff; }
        .light-mode { --bg: #fdfcfb; --card: #ffffff; --text: #1e293b; }
        body { background: var(--bg); color: var(--text); font-family: 'Plus Jakarta Sans', sans-serif; transition: 0.4s; }
        .glass { background: var(--card); backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.05); border-radius: 28px; }
        .owner-badge { background: linear-gradient(90deg, #6366f1, #a855f7); }
        #qrcode img { margin: 0 auto; border: 10px solid white; border-radius: 12px; }
    </style>
</head>
<body class="p-4 max-w-md mx-auto pb-40">

    <div class="flex justify-between items-center mb-6 pt-4">
        <button onclick="toggleTheme()" class="bg-indigo-600 text-white px-4 py-1 rounded-full text-[10px] font-black italic shadow-lg">
            <i class="fas fa-palette mr-1"></i> THEME
        </button>
        <div id="clock" class="text-xs font-bold opacity-40 italic">00:00:00</div>
        <button onclick="exportData()" class="bg-slate-700 text-white px-4 py-1 rounded-full text-[10px] font-black">
            <i class="fas fa-file-export mr-1"></i> BACKUP
        </button>
    </div>

    <div class="text-center mb-8">
        <div class="inline-block owner-badge px-6 py-1 rounded-full mb-3 shadow-xl">
            <p class="text-[9px] font-black text-white uppercase tracking-[3px]">Proprietor: Pradeep Verma</p>
        </div>
        <h1 class="text-5xl font-black italic tracking-tighter text-indigo-500">NEXA <span class="text-inherit opacity-80">VISION</span></h1>
        <p class="text-[8px] font-bold opacity-40 uppercase tracking-[4px] mt-2 italic">Managed by Khagesh ai-nexa</p>
    </div>

    <div class="glass p-6 mb-10 shadow-2xl border-t-4 border-indigo-500">
        <div class="space-y-4">
            <div class="grid grid-cols-2 gap-3">
                <input type="text" id="pName" placeholder="Customer Name" class="p-4 rounded-xl bg-black/10 border border-white/5 outline-none font-bold">
                <input type="tel" id="pPhone" placeholder="Mobile No." class="p-4 rounded-xl bg-black/10 border border-white/5 outline-none font-bold">
            </div>
            
            <div class="p-4 rounded-2xl bg-indigo-500/5 border border-indigo-500/20">
                <p class="text-[8px] font-black text-indigo-500 uppercase mb-3 tracking-widest text-center">Vision Power Matrix</p>
                <div class="grid grid-cols-2 gap-4">
                    <div class="space-y-2 text-center">
                        <label class="text-[9px] opacity-40 font-bold">RIGHT EYE (RE)</label>
                        <input type="text" id="rPower" placeholder="+0.50 Sph" class="bg-transparent border-b border-indigo-500/30 text-center text-xs p-1 outline-none w-full">
                    </div>
                    <div class="space-y-2 text-center">
                        <label class="text-[9px] opacity-40 font-bold">LEFT EYE (LE)</label>
                        <input type="text" id="lPower" placeholder="+0.75 Sph" class="bg-transparent border-b border-indigo-500/30 text-center text-xs p-1 outline-none w-full">
                    </div>
                </div>
            </div>

            <textarea id="pMeds" placeholder="Frame details or lens brand..." class="w-full p-4 rounded-xl bg-black/10 border border-white/5 text-sm h-16 outline-none"></textarea>
            
            <div class="grid grid-cols-2 gap-4">
                <input type="number" id="pFees" placeholder="Total Bill ₹" class="p-4 rounded-xl bg-black/10 border border-white/5 font-black text-emerald-500 outline-none">
                <button onclick="saveRecord()" class="bg-indigo-600 text-white font-black rounded-xl uppercase tracking-widest text-[10px] shadow-lg shadow-indigo-500/30">Save Record</button>
            </div>
        </div>
    </div>

    <div id="patientList" class="space-y-4"></div>

    <div id="qrModal" class="fixed inset-0 bg-black/95 hidden z-50 flex items-center justify-center p-6">
        <div class="bg-white p-8 rounded-[40px] text-center w-full">
            <div id="qrcode" class="mb-4"></div>
            <p class="text-black font-black italic text-sm">Pradeep Verma Opticals</p>
            <p class="text-slate-400 text-[8px] mb-6 uppercase tracking-widest">Digital Prescription QR</p>
            <button onclick="closeQR()" class="bg-indigo-600 text-white px-10 py-3 rounded-2xl font-black text-[10px] uppercase">Close</button>
        </div>
    </div>

    <footer class="fixed bottom-0 left-0 w-full p-8 bg-inherit backdrop-blur-md text-center border-t border-white/5">
        <h2 class="text-xl font-black italic opacity-80">Khagesh <span class="text-indigo-500">ai-nexa</span></h2>
        <p class="text-[8px] font-bold opacity-40 tracking-[5px] uppercase mt-1">Next-Gen Optical Solutions</p>
    </footer>

    <script>
        function updateClock() { document.getElementById('clock').innerText = new Date().toLocaleTimeString('en-IN', {hour12: false}); }
        setInterval(updateClock, 1000); updateClock();

        let records = JSON.parse(localStorage.getItem('nexa_optical_v3')) || [];

        function saveRecord() {
            const name = document.getElementById('pName').value;
            const phone = document.getElementById('pPhone').value;
            if(!name || !phone) return alert("Details bharo bhai!");

            records.unshift({
                id: Date.now(),
                name, phone,
                rPower: document.getElementById('rPower').value,
                lPower: document.getElementById('lPower').value,
                notes: document.getElementById('pMeds').value,
                fees: document.getElementById('pFees').value || '0',
                date: new Date().toLocaleDateString('en-IN')
            });

            localStorage.setItem('nexa_optical_v3', JSON.stringify(records));
            render();
            ['pName', 'pPhone', 'rPower', 'lPower', 'pMeds', 'pFees'].forEach(id => document.getElementById(id).value = '');
        }

        function render() {
            const list = document.getElementById('patientList');
            list.innerHTML = '';
            records.forEach(r => {
                const card = document.createElement('div');
                card.className = "glass p-6 mb-4 border-l-4 border-indigo-500";
                card.innerHTML = `
                    <div class="flex justify-between items-start mb-4">
                        <div>
                            <h5 class="font-bold text-lg leading-tight">${r.name}</h5>
                            <p class="text-[8px] opacity-50 font-black uppercase tracking-widest">${r.date}</p>
                        </div>
                        <div class="flex gap-2">
                            <button onclick="generateQR(${r.id})" class="text-indigo-400 p-2 bg-indigo-500/10 rounded-xl"><i class="fas fa-qrcode"></i></button>
                            <button onclick="shareWA(${r.id})" class="text-emerald-500 p-2 bg-emerald-500/10 rounded-xl"><i class="fab fa-whatsapp"></i></button>
                            <button onclick="deleteRec(${r.id})" class="text-rose-500 opacity-30"><i class="fas fa-trash"></i></button>
                        </div>
                    </div>
                    <div class="grid grid-cols-2 gap-2 mb-3 bg-indigo-500/5 p-3 rounded-xl">
                        <p class="text-[10px]"><span class="font-black text-indigo-500">RE:</span> ${r.rPower || 'N/A'}</p>
                        <p class="text-[10px]"><span class="font-black text-indigo-500">LE:</span> ${r.lPower || 'N/A'}</p>
                    </div>
                    <div class="flex justify-between items-center px-1">
                        <p class="text-[9px] font-black text-emerald-500 italic">Paid: ₹${r.fees}</p>
                        <p class="text-[7px] font-bold opacity-30 uppercase">Pradeep Verma Vision</p>
                    </div>
                `;
                list.appendChild(card);
            });
        }

        function toggleTheme() { document.body.classList.toggle('light-mode'); }

        function generateQR(id) {
            const r = records.find(x => x.id === id);
            document.getElementById('qrcode').innerHTML = '';
            new QRCode(document.getElementById('qrcode'), { 
                text: `Pradeep Verma Opticals | Patient: ${r.name} | Power RE: ${r.rPower} LE: ${r.lPower}`, 
                width: 200, height: 200 
            });
            document.getElementById('qrModal').classList.remove('hidden');
        }

        function closeQR() { document.getElementById('qrModal').classList.add('hidden'); }

        function shareWA(id) {
            const r = records.find(x => x.id === id);
            const msg = `*PRADEEP VERMA OPTICALS*%0A*Customer:* ${r.name}%0A*RE:* ${r.rPower}%0A*LE:* ${r.lPower}%0A*Bill:* ₹${r.fees}%0A---%0A_Powered by Khagesh ai-nexa_`;
            window.open(`https://wa.me/91${r.phone}?text=${msg}`);
        }

        function exportData() {
            const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(records));
            const dl = document.createElement('a');
            dl.setAttribute("href", dataStr);
            dl.setAttribute("download", "pradeep_verma_backup.json");
            dl.click();
        }

        function deleteRec(id) {
            if(confirm("Delete record?")) {
                records = records.filter(r => r.id !== id);
                localStorage.setItem('nexa_optical_v3', JSON.stringify(records));
                render();
            }
        }
        render();
    </script>
</body>
    </html>
    
